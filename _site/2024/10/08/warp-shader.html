<!DOCTYPE html><html lang="en" ><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Warp shader" /><meta property="og:locale" content="en_US" /><meta name="description" content="A post describing a shader effect." /><meta property="og:description" content="A post describing a shader effect." /><link rel="canonical" href="http://localhost:4000/2024/10/08/warp-shader" /><meta property="og:url" content="http://localhost:4000/2024/10/08/warp-shader" /><meta property="og:site_name" content="Marlon Etheredge" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-10-08T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Warp shader" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-10-08T00:00:00+02:00","datePublished":"2024-10-08T00:00:00+02:00","description":"A post describing a shader effect.","headline":"Warp shader","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2024/10/08/warp-shader"},"url":"http://localhost:4000/2024/10/08/warp-shader"}</script><title> Warp shader - Marlon Etheredge</title><link rel="shortcut icon" href="/favicon.png"><link rel="alternate" type="application/atom+xml" title="Marlon Etheredge" href="/atom.xml"><link rel="alternate" type="application/json" title="Marlon Etheredge" href="http://localhost:4000/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="/sitemap.xml" /><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}body{font-family:system-ui,sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;line-height:1.5;font-size:1rem;color:#16171a}nav ul{border-right:1px solid #edf2f7}a{color:#000;text-decoration-skip-ink:auto;text-decoration:underline}pre{margin:.5rem 0;padding:.5rem}.post p{margin:.5rem 0}.post h1,.post h2,.post h3,.post h4{margin:1rem 0}.post h2:first-child,.project h2:first-child,.photo h2:first-child{margin-top:0}.meta{margin:2rem 0}code,pre{background:#ecedee}code{padding:.1rem}pre code{border:none}pre{padding:1rem;overflow-x:auto}img{max-width:100%}hr{background:#000;height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem}blockquote{font-style:italic;border-left:5px solid #ececec;padding-left:1rem}h1,h2,h3,h4,h5{line-height:1;margin:1rem 0;font-weight:600}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:.5rem}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}main{display:flex;flex-wrap:wrap;max-width:60rem;margin:2rem auto;padding:1rem}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:.5rem}}section{flex-basis:0;flex-grow:999;min-width:70%;display:flex;flex-direction:column}figcaption{font-size:smaller}@media print{.no-print,.no-print *{display:none !important}}</style></head><body><main><header aria-hidden="true" class="no-print"> <!--<h1 class="logo">Marlon Etheredge</h1>--><nav role="navigation" aria-hidden="true"><ul><li><a href="/" >Writing</a></li><li><a href="/about" >About</a></li><li><a href="/search" >Search</a></li><li><a href="/atom.xml" >Rss</a></li></ul></nav></header><section class="post"><h2>Warp shader</h2><p>The previous version of this website featured a background that aligned with its retro aesthetic, created using a multi-pass GLSL shader.</p><p>The effect can be seen below.</p><div class="shader"> <script type="text/javascript" src="/assets/js/three.min.js"></script> <canvas id="c"></canvas> <script type="text/javascript" src="/assets/js/warp-shader.js"></script></div><p>Two shaders are used to create the effect: the first generates a “warp” effect by stepping through a noise function, while the second is a post-processing shader that adds jitter and chromatic aberration. This effect utilizes two render passes, with the “warp” shader rendering to a render target and the post-processing shader rendering to the default frame buffer using the previously generated render target.</p><h2 id="warp-effect">Warp effect</h2><pre><code class="language-c">varying vec2 UV;

uniform float Time;

uniform vec2 Resolution;

float noise(vec2 x) {
    return fract(sin(dot(x / 500.0, vec2(12.9898, 78.233))) * 43758.5453);
}

void main() {
    vec3 r = vec3(2.0 * (gl_FragCoord.xy - Resolution * 0.5) / Resolution, (sin(Time * 0.01) * 0.5 + 0.5) * 0.6 + 0.4);

    float o = Time * 0.08;

    vec3 c = vec3(0.0);
    vec3 s = r / max(abs(r.x), abs(r.y));
    vec3 p = 2.0 * s + 0.1;

    for (int i = 0; i &lt; 20; ++i, p += s) {
        vec3 d = vec3(30.0 * fract(noise(round(p.xy)) - o) - p.z);
        c += max(vec3(0.0), vec3(0.9) - abs(d * vec3(0.76))) * d;
    }

    gl_FragColor = vec4(c, 1.0);
}
</code></pre><h2 id="post-processing-effect">Post-processing effect</h2><pre><code class="language-c">varying vec2 UV;

uniform float Time;

uniform sampler2D Tex;

const vec2 randConst = vec2(12.9898, 78.233);

const float randMultiplier = 43758.5453;
const float smoothstepWidth = 0.02;
const float textureOffsets[3] = float[](0.010, 0.005, 0.000);

void main() {
    vec2 uv = UV;

    float smoothstepRange = 1.0 / 15.0;
    float smoothstepStart = smoothstepRange * (floor(Time * 0.5 / smoothstepRange));
    float smoothstepEnd = smoothstepStart + smoothstepRange;
    float smoothstepValue = smoothstep(smoothstepStart, smoothstepEnd, uv.y);

    float o = 0.01 * sin(1.0 - tan(Time * 0.005));

    uv.x += (smoothstepValue * o) - ((1.0 - smoothstepValue) * o);
    uv.x += fract(sin(dot(vec2(Time * 0.00001, floor(uv.y * 200.0) / 200.0), randConst)) * randMultiplier) * 0.005;

    vec4 texValue = vec4(0.0, 0.0, 0.0, 1.0);
    for (int i = 0; i &lt; 3; ++i) {
        texValue[i] = texture(Tex, uv + vec2(textureOffsets[i], 0.0)).r;
    }
    texValue.w = 1.0;

    gl_FragColor = texValue;
}
</code></pre><span class="meta"><time datetime="2024-10-08T00:00:00+02:00">October 8, 2024</time> &middot; <a href="/tag/shaders">shaders</a></span></section></main></body></html>
